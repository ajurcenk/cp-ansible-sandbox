all:
   vars:
      all_ssl_password: "{{vault_ssl_password}}"
      pkcs12_enabled: false #Optional to use PKSC12 over JKS
      ssl_custom_certs: false #Set to true to provide your own certs & keys. Provide the following properties.
#      ssl_ca_cert_filepath: 
#      ssl_signed_cert_filepath:
#      ssl_key_filepath: 
      ssl_provided_keystore_and_truststore: true #If true provide the keystores
      ssl_keystore_filepath: "ssl-certs/{{inventory_hostname}}.keystore.jks"
      ssl_keystore_key_password: "{{all_ssl_password}}"
      ssl_keystore_store_password: "{{all_ssl_password}}"
      ssl_truststore_filepath: "ssl-certs/{{inventory_hostname}}.truststore.jks"
      ssl_truststore_password: "{{all_ssl_password}}"
      sasl_protocol: none
      confluent_repo_version: 5.4 #Optional
      confluent_package_version: 5.4.0 #Optional
      confluent:
         support:
            metrics_enabled: false
            customer_id: ""
      install_netcat: false #Defaults to true
      install_java: true #Disable if you wish to get Java from elsewhere
      jolokia_enabled: false #Disables Jolokia download/install
      jmxexporter_enabled: false #Enable to install Prometheus
      kafka_broker_configure_additional_brokers: true #The following 3 sets are needed to provide proper advertisment
      kafka_broker_inter_broker_listener_name: external
      kafka_broker_custom_listeners: 
         external:
            name: EXTERNAL
            port: 9092
            ssl_enabled: true #SSL can be enabled directly here or by defining ssl_enabled globally
            ssl_mutual_auth_enabled: false
            sasl_protocol: scram
            hostname: "{{inventory_hostname}}"
         rbac:
            name: RBAC
            port: 9093
            ssl_enabled: true
            ssl_mutual_auth_enabled: "{{ ssl_mutual_auth_enabled }}"
            sasl_protocol: OAUTHBEARER
            server_callback: io.confluent.kafka.server.plugins.auth.token.TokenBearerValidatorCallbackHandler
            login_callback: io.confluent.kafka.server.plugins.auth.token.TokenBearerServerLoginCallbackHandler
            options:
              publicKeyPath: "{{ rbac_mds_public_key_path }}"
            hostname: "{{inventory_hostname}}"
      rbac_enabled: true
      rbac_mds_public_key_filepath: pem/public.pem
      rbac_mds_private_key_filepath: pem/tokenKeypair.pem
      rbac_mds_public_key_filename: public.pem
      rbac_mds_private_key_filename: tokenKeypair.pem
      rbac_mds_public_key_path: "/var/ssl/private/{{rbac_mds_public_key_filename}}"
      rbac_mds_private_key_path: "/var/ssl/private/{{rbac_mds_private_key_filename}}"
      #Enable the below to turn SSL/TLS for the REST interfaces
      control_center_ssl_enabled: false 
      ksql_ssl_enabled: false
      kafka_connect_ssl_enabled: false
      kafka_rest_ssl_enabled: false
      schema_registry_ssl_enabled: false
      #STOP
      
      
zookeeper:
   hosts:
      zk[1:3].nikoleta.aws.ps.confluent.io:
   vars:
      zookeeper_data_dir: /var/lib/zookeeper
      zookeeper:
         log_path: /var/log/kafka/
         properties:
            '4lw.commands.whitelist': "stat, ruok, srvr, mntr"
         
kafka_broker:
   hosts:
      kfk1.nikoleta.aws.ps.confluent.io:
      kfk2.nikoleta.aws.ps.confluent.io:
      kfk3.nikoleta.aws.ps.confluent.io:
   vars:
      kafka_broker_service_environment_overrides:
         KAFKA_HEAP_OPTS: "-Xmx1g"
      kafka_broker:
         datadir:
            - /var/lib/kafka/data
         properties:
            num.partitions: 3
            min.insync.replicas: 2
            log.retention.hours: 3 #Adjust to desired value. Set low for test envs.
            default.replication.factor: 3
            #MetricsReport Specific Configs
            confluent.metrics.reporter.topic.partitions: 12
            confluent.metrics.reporter.topic.replicas: 3
            confluent.metrics.reporter.topic.retention.ms: 10800000 #Adjust to desired value. Set low for test envs.
            #RBAC/MDS Configurations
            authorizer.class.name: io.confluent.kafka.security.authorizer.ConfluentServerAuthorizer
            confluent.authorizer.access.rule.providers: ZK_ACL,CONFLUENT
            ldap.group.name.attribute: sAMAccountName
            ldap.group.object.class: group
            ldap.group.search.base: OU=BOOTCAMP,DC=ad,DC=bootcamp,DC=confluent,DC=io
            ldap.group.search.scope: 2
            ldap.java.naming.provider.url: ldap://ad.bootcamp.confluent.io:389
            ldap.java.naming.security.authentication: simple
            ldap.java.naming.security.credentials: 
            ldap.java.naming.security.principal: "CN=Nikoleta KFK1,OU=Nikoleta,OU=BOOTCAMP,DC=ad,DC=bootcamp,DC=confluent,DC=io"
            ldap.user.name.attribute: sAMAccountName
            ldap.user.object.class: user
            ldap.user.search.base: OU=BOOTCAMP,DC=ad,DC=bootcamp,DC=confluent,DC=io
            ldap.user.search.scope: 2
#            ldap.java.naming.security.protocol: SSL
#            ldap.ssl.truststore.location: "{{kafka_broker_truststore_path}}"
#            ldap.ssl.truststore.password: "{{kafka_broker_truststore_storepass}}"
            super.users: User:admin
            broker.users: User:admin
            confluent.metadata.server.advertised.listeners: "https://{{inventory_hostname}}:8090"
            confluent.metadata.server.listeners: https://0.0.0.0:8090
            confluent.metadata.server.authentication.method: BEARER
            confluent.metadata.server.public.key.path: "{{rbac_mds_public_key_path}}"
            confluent.metadata.server.token.key.path: "{{rbac_mds_private_key_path}}"
            confluent.metadata.server.ssl.keystore.location: "{{kafka_broker_keystore_path}}"
            confluent.metadata.server.ssl.keystore.password: "{{kafka_broker_keystore_storepass}}"
            confluent.metadata.server.ssl.key.password: "{{kafka_broker_keystore_keypass}}"
            confluent.metadata.server.ssl.truststore.location: "{{kafka_broker_truststore_path}}"
            confluent.metadata.server.ssl.truststore.password: "{{kafka_broker_truststore_storepass}}"
            confluent.metadata.server.token.max.lifetime.ms: 3600000
            
control_center:
   hosts:
      ccc1.nikoleta.aws.ps.confluent.io:
   vars:
      control_center_custom_java_args: " -Djava.io.tmpdir=/tmp"
      control_center_service_environment_overrides:
         ROCKSDB_SHAREDLIB_DIR: /tmp
      control_center:
         properties:
            confluent.controlcenter.ksql.enable: 'false' #Set to false if no KSQL Servers
            confluent.controlcenter.schema.registry.enable: 'false' # Set to false if no Schema Registry
            confluent.controlcenter.data.dir: /var/lib/confluent/control-center
            # Enable RBAC authorization in Control Center by providing a comma-separated list of Metadata Service (MDS) URLs
            confluent.metadata.bootstrap.server.urls: "{% for host in groups['kafka_broker'] %}{% if loop.index > 1%},{% endif %}https://{{ host }}:8090{% endfor %}"
            # MDS credentials of an RBAC user for Control Center to act on behalf of
            # NOTE: This user must be a SystemAdmin on each Apache Kafka cluster
            confluent.metadata.basic.auth.user.info: "{{sasl_scram_users.control_center.principal}}:{{sasl_scram_users.control_center.password}}"
            # Enable authentication using a bearer token for Control Center's REST endpoints
            confluent.controlcenter.rest.authentication.method: BEARER
            # NOTE: Must match the MDS public key
            public.key.path: "{{rbac_mds_public_key_path}}"
            
schema_registry:
   hosts:
      sr1.nikoleta.aws.ps.confluent.io:
                  
kafka_connect:
   hosts:
      connect1.nikoleta.aws.ps.confluent.io:
   vars:
      kafka_connect:
         properties:
            rest.advertised.host.name: "{{inventory_hostname}}"
                      
ksql:
   hosts:
      ksql1.nikoleta.aws.ps.confluent.io:
   vars:
      ksql_jolokia_port: 7774 #Needed regardless of Jolokia being enabled
      kafka_port: 9092
      ksql_listener_port: 8088 #Optional
      
kafka_rest:
   hosts:
      rest1.nikoleta.aws.ps.confluent.io:
   vars:
      kafka_rest_jolokia_port: 7775 #Needed regardless of Jolokia being enabled
      kafka_port: 9092